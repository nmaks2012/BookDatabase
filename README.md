# Хранилище книг на C++23

Данный проект представляет собой реализацию шаблонного класса-контейнера `BookDatabase` для эффективного хранения и управления коллекцией книг. Цель проекта — продемонстрировать применение современных возможностей C++ (включая C++23) для создания производительных и удобных в использовании структур данных. В ходе разработки были применены концепты, свёрточные выражения, "плоские" контейнеры и гетерогенный поиск.

## Ключевые особенности

- **Современный C++:** Проект активно использует возможности C++23, включая концепты, `std::span`, `std::format`, `std::string_view` и свёрточные выражения (fold expressions).
- **Эффективное хранение:** Реализован шаблонный класс-контейнер `BookDatabase` с использованием `std::unordered_set` и `std::vector` для данных, а также `std::string_view` для эффективного хранения имён авторов.
- **Продвинутые контейнеры:** Применяются "плоские" контейнеры, такие как `std::flat_map` и `boost::container::flat_set`, для повышения производительности в задачах анализа данных.
- **Гетерогенный поиск:** Используются прозрачные компараторы для эффективного поиска в ассоциативных контейнерах без создания временных объектов.
- **Статистический анализ:** Набор функций для анализа коллекции:
  - Построение гистограммы авторов (`buildAuthorHistogramFlat`).
  - Расчёт среднего рейтинга по жанрам (`calculateGenreRatings`).
  - Выборка N лучших книг по рейтингу (`getTopNBy`).
  - Случайная выборка книг (`sampleRandomBooks`).
- **Гибкая фильтрация:**
  - Функция `filterBooks` для фильтрации коллекции по заданным критериям.
  - Фабрики предикатов (`YearBetween`, `RatingAbove`, `GenreIs`) для создания условий "на лету".
  - Композиция предикатов с помощью `all_of` и `any_of` для создания сложных фильтров.
- **Совместимость с STL:** Контейнер `BookDatabase` предоставляет итераторы и псевдонимы типов, что позволяет использовать его со стандартными алгоритмами STL.
- **Тестирование:** Проект покрыт юнит-тестами с использованием Google Test для обеспечения корректности и надёжности.

## Сборка проекта и запуск тестов

Данный репозиторий использует три инструмента:

- **Conan** — свободный менеджер пакетов для C и C++ с открытым исходным кодом (MIT). Позволяет настраивать процесс сборки программ, скачивать и устанавливать сторонние зависимости и необходимые инструменты. Подробнее о Conan:
  - https://habr.com/ru/articles/884464
  - https://docs.conan.io/2.0/tutorial/consuming_packages/build_simple_cmake_project.html
  - https://docs.conan.io/2.0/tutorial/consuming_packages/the_flexibility_of_conanfile_py.html

- **cmake** — генератор систем сборки для C и C++. Позволяет создавать проекты, которые могут компилироваться на различных платформах и с различными компиляторами. Подробнее о cmake:
  - https://dzen.ru/a/ZzZGUm-4o0u-IQlb
  - https://neerc.ifmo.ru/wiki/index.php?title=CMake_Tutorial
  - https://cmake.org/cmake/help/book/mastering-cmake/cmake/Help/guide/tutorial/index.html

- **VS Code Dev Docker container** - Docker контейнер, который содержит полностью настроенное окружение для выполнение задания. Подробнее об этой функциональности:
  - https://habr.com/ru/articles/822707/ - "Почти все, что вы хотели бы знать про Docker"
  - https://code.visualstudio.com/docs/devcontainers/containers - официальная документация VS Code
  - https://www.youtube.com/watch?v=p9L7YFqHGk4 - "Docker container for VS Code"
  - https://www.youtube.com/watch?v=pg19Z8LL06w&t=174s&pp=ygUPRG9ja2VyY29udGFpbmVy - "Docker in 1 hour"

### Команды для сборки проекта

Используйте `F5` для выполнения следующих шагов:
- Создание папки `build`
- Вызов `conan` команд для установки требуемых библиотек и запуска процесса сборки
- Запуска `lldb` отладчика

### Команды для запуска приложения

```bash
cd build
./BookDB 
```

### Команда для запуска тестов

```bash
cd build
./BookDB_tests
```

### Команды для запуска отладчика

В `Visual Studio Code` настройки параметров для запуска отладчика находятся в `.vscode/launch.json` файле. Поскольку в этом файле уже есть одна конфигурация `Launch CryptoGuard` для запуска приложения, которое вычисляет контрольную сумму файла, то для запуска отладчика достаточно нажать `F5` или открыть окно `Run and Debug` комбинацией клавиш `Ctrl+Shift+D`.

## Дополнительно

- Автодополнение `Ctrl + Space`. Для настройки автодополнения вам необходимо нажать `F1` и выполнить команду `clangd: Download language server`. VS Code сам предложит установить подходящую версию `clangd` (всплывашка в правом нижнем углу). После завершения установки потребуется перезагрузить окно (кнопка перезапуска будет находиться также справа снизу или нажать `F1` и выполнить команду `Developer: Reload Window`)

Если всё сделано правильно - после успешной сборки проекта вы сможете использовать автодополнение
